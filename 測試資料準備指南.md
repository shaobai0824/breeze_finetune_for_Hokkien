# æ¸¬è©¦è³‡æ–™é›†æº–å‚™æŒ‡å—

## ğŸ“‹ è³‡æ–™æ ¼å¼è¦æ±‚

### 1. è³‡æ–™å¤¾çµæ§‹

```
test_dataset/
â”œâ”€â”€ audio/                    # éŸ³è¨Šæª”æ¡ˆ (å¿…éœ€)
â”‚   â”œâ”€â”€ test_001.wav
â”‚   â”œâ”€â”€ test_002.wav
â”‚   â”œâ”€â”€ test_003.wav
â”‚   â””â”€â”€ ...
â”œâ”€â”€ test_references.csv       # åƒè€ƒæ–‡æœ¬ (å¿…éœ€)
â””â”€â”€ metadata.json           # è³‡æ–™é›†æè¿° (é¸ç”¨)
```

### 2. éŸ³è¨Šæª”æ¡ˆè¦æ±‚

#### æ ¼å¼è¦ç¯„ï¼š
- **æª”æ¡ˆæ ¼å¼**ï¼š`.wav` (æ¨è–¦) æˆ– `.mp3`
- **å–æ¨£ç‡**ï¼š16kHz (æœƒè‡ªå‹•é‡æ–°å–æ¨£)
- **è²é“**ï¼šå–®è²é“ (mono)
- **æ™‚é•·**ï¼šå»ºè­° 0.5-10 ç§’
- **å“è³ª**ï¼šæ¸…æ™°ã€ç„¡æ˜é¡¯é›œéŸ³

#### å‘½åè¦å‰‡ï¼š
- ä½¿ç”¨æœ‰æ„ç¾©çš„æª”æ¡ˆåç¨±
- ä¾‹å¦‚ï¼š`test_001.wav`, `daily_greeting_01.wav`, `number_seq_05.wav`
- é¿å…ä¸­æ–‡æª”åï¼Œä½¿ç”¨è‹±æ–‡å’Œæ•¸å­—

### 3. CSV åƒè€ƒæ–‡æœ¬æ ¼å¼

#### å¿…éœ€æ¬„ä½ï¼š
```csv
filename,transcription
test_001.wav,ä»Šå¤©å¤©æ°£å¾ˆå¥½
test_002.wav,æˆ‘è¦è²·ä¸€æ¯å’–å•¡
```

#### å®Œæ•´æ ¼å¼ï¼ˆæ¨è–¦ï¼‰ï¼š
```csv
filename,transcription,domain,duration,speaker_id,difficulty
test_001.wav,ä»Šå¤©å¤©æ°£å¾ˆå¥½,weather,2.3,speaker_a,easy
test_002.wav,æˆ‘è¦è²·ä¸€æ¯å’–å•¡,daily_life,1.8,speaker_b,easy
test_003.wav,è«‹å•ç¾åœ¨å¹¾é»äº†,time_query,2.1,speaker_a,medium
test_004.wav,å°åŒ—ä¸€é›¶ä¸€å¤§æ¨“å¾ˆé«˜,landmark,2.5,speaker_c,medium
test_005.wav,æˆ‘çš„é›»è©±è™Ÿç¢¼æ˜¯é›¶ä¹ä¸€äºŒä¸‰å››äº”å…­ä¸ƒå…«,number,4.2,speaker_b,hard
```

#### æ¬„ä½èªªæ˜ï¼š
- `filename` (å¿…éœ€)ï¼šéŸ³è¨Šæª”æ¡ˆåç¨±
- `transcription` (å¿…éœ€)ï¼šæ­£ç¢ºçš„è½‰éŒ„æ–‡æœ¬
- `domain` (é¸ç”¨)ï¼šé ˜åŸŸåˆ†é¡ï¼ˆweather, daily_life, number, locationç­‰ï¼‰
- `duration` (é¸ç”¨)ï¼šéŸ³è¨Šæ™‚é•·ï¼ˆç§’ï¼‰
- `speaker_id` (é¸ç”¨)ï¼šèªªè©±è€…è­˜åˆ¥ç¢¼
- `difficulty` (é¸ç”¨)ï¼šé›£åº¦ç­‰ç´šï¼ˆeasy, medium, hardï¼‰

## ğŸ¯ å»ºè­°çš„æ¸¬è©¦å ´æ™¯

### 1. æ—¥å¸¸å°è©±
```csv
filename,transcription,domain
daily_01.wav,ä½ å¥½å—,greeting
daily_02.wav,ä»Šå¤©å¤©æ°£çœŸå¥½,weather
daily_03.wav,æˆ‘è¦å»è²·æ±è¥¿,shopping
daily_04.wav,è¬è¬ä½ çš„å¹«åŠ©,gratitude
```

### 2. æ•¸å­—å’Œæ™‚é–“
```csv
filename,transcription,domain
num_01.wav,ä¸€äºŒä¸‰å››äº”,number
num_02.wav,æˆ‘çš„é›»è©±æ˜¯é›¶ä¹ä¸€äºŒä¸‰å››äº”å…­ä¸ƒå…«,phone_number
time_01.wav,ç¾åœ¨æ˜¯ä¸‹åˆä¸‰é»,time
time_02.wav,æ˜å¤©æ—©ä¸Šå…«é»è¦‹é¢,appointment
```

### 3. åœ°åå’Œå°ˆæœ‰åè©
```csv
filename,transcription,domain
place_01.wav,æˆ‘ä½åœ¨å°åŒ—å¸‚,location
place_02.wav,è¦å»å°ä¸­ç«è»Šç«™,transportation
place_03.wav,å°ç£å¤§å­¸å¾ˆæœ‰å,institution
```

### 4. å£èªåŒ–è¡¨é”
```csv
filename,transcription,domain
casual_01.wav,è›¤ï¼Ÿä»€éº¼æ„æ€,question
casual_02.wav,è¶…å¥½åƒçš„å•¦,opinion
casual_03.wav,ç­‰ç­‰å†èªª,casual_response
```

## ğŸ“Š å»ºè­°çš„è³‡æ–™é›†å¤§å°

### æœ€å°æ¸¬è©¦é›†ï¼š
- **æª”æ¡ˆæ•¸é‡**ï¼š20-50 å€‹
- **ç¸½æ™‚é•·**ï¼š2-5 åˆ†é˜
- **æ¶µè“‹é ˜åŸŸ**ï¼š3-5 å€‹ä¸åŒé ˜åŸŸ

### æ¨™æº–æ¸¬è©¦é›†ï¼š
- **æª”æ¡ˆæ•¸é‡**ï¼š100-200 å€‹
- **ç¸½æ™‚é•·**ï¼š10-20 åˆ†é˜
- **æ¶µè“‹é ˜åŸŸ**ï¼š5-8 å€‹ä¸åŒé ˜åŸŸ
- **èªªè©±è€…**ï¼š3-5 å€‹ä¸åŒèªªè©±è€…

### å…¨é¢æ¸¬è©¦é›†ï¼š
- **æª”æ¡ˆæ•¸é‡**ï¼š500+ å€‹
- **ç¸½æ™‚é•·**ï¼š50+ åˆ†é˜
- **æ¶µè“‹é ˜åŸŸ**ï¼š10+ å€‹ä¸åŒé ˜åŸŸ
- **èªªè©±è€…**ï¼š10+ å€‹ä¸åŒèªªè©±è€…

## ğŸ”§ è³‡æ–™æº–å‚™å·¥å…·

### 1. éŸ³è¨Šè™•ç†è…³æœ¬

```python
import librosa
import soundfile as sf
import os

def process_audio_file(input_path, output_path, target_sr=16000):
    """è™•ç†éŸ³è¨Šæª”æ¡ˆï¼šè½‰æ›ç‚º16kHzå–®è²é“"""
    # è¼‰å…¥éŸ³è¨Š
    audio, sr = librosa.load(input_path, sr=target_sr, mono=True)
    
    # å„²å­˜è™•ç†å¾Œçš„éŸ³è¨Š
    sf.write(output_path, audio, target_sr)
    
    return len(audio) / target_sr  # è¿”å›æ™‚é•·

def batch_process_audio(input_folder, output_folder):
    """æ‰¹æ¬¡è™•ç†éŸ³è¨Šæª”æ¡ˆ"""
    os.makedirs(output_folder, exist_ok=True)
    
    for filename in os.listdir(input_folder):
        if filename.lower().endswith(('.wav', '.mp3', '.m4a')):
            input_path = os.path.join(input_folder, filename)
            output_path = os.path.join(output_folder, f"{os.path.splitext(filename)[0]}.wav")
            
            try:
                duration = process_audio_file(input_path, output_path)
                print(f"âœ… {filename} -> {duration:.2f}s")
            except Exception as e:
                print(f"âŒ {filename}: {e}")

# ä½¿ç”¨ç¯„ä¾‹
# batch_process_audio("raw_audio/", "test_dataset/audio/")
```

### 2. CSV ç”Ÿæˆè…³æœ¬

```python
import pandas as pd
import os
import librosa

def create_test_csv(audio_folder, transcriptions, output_csv):
    """å‰µå»ºæ¸¬è©¦è³‡æ–™CSVæª”æ¡ˆ"""
    data = []
    
    for filename, transcription in transcriptions.items():
        audio_path = os.path.join(audio_folder, filename)
        
        if os.path.exists(audio_path):
            # è¨ˆç®—éŸ³è¨Šæ™‚é•·
            try:
                duration = librosa.get_duration(filename=audio_path)
                data.append({
                    'filename': filename,
                    'transcription': transcription,
                    'duration': round(duration, 2)
                })
            except:
                print(f"è­¦å‘Šï¼šç„¡æ³•è®€å– {filename}")
    
    # å‰µå»ºDataFrameä¸¦å„²å­˜
    df = pd.DataFrame(data)
    df.to_csv(output_csv, index=False, encoding='utf-8')
    print(f"âœ… å·²å‰µå»º {output_csv}ï¼ŒåŒ…å« {len(data)} å€‹æ¨£æœ¬")

# ä½¿ç”¨ç¯„ä¾‹
transcriptions = {
    "test_001.wav": "ä»Šå¤©å¤©æ°£å¾ˆå¥½",
    "test_002.wav": "æˆ‘è¦è²·ä¸€æ¯å’–å•¡",
    # ... æ›´å¤šè½‰éŒ„æ–‡æœ¬
}

create_test_csv("test_dataset/audio/", transcriptions, "test_dataset/test_references.csv")
```

## âœ… è³‡æ–™å“è³ªæª¢æŸ¥æ¸…å–®

### éŸ³è¨Šå“è³ªæª¢æŸ¥ï¼š
- [ ] æ‰€æœ‰éŸ³è¨Šæª”æ¡ˆéƒ½èƒ½æ­£å¸¸æ’­æ”¾
- [ ] éŸ³è³ªæ¸…æ™°ï¼Œç„¡æ˜é¡¯é›œéŸ³
- [ ] éŸ³é‡é©ä¸­ï¼Œä¸æœƒéå¤§æˆ–éå°
- [ ] æ™‚é•·åœ¨åˆç†ç¯„åœå…§ï¼ˆ0.5-10ç§’ï¼‰

### æ–‡æœ¬å“è³ªæª¢æŸ¥ï¼š
- [ ] è½‰éŒ„æ–‡æœ¬æº–ç¢ºç„¡èª¤
- [ ] æ²’æœ‰éŒ¯åˆ¥å­—æˆ–æ¨™é»ç¬¦è™ŸéŒ¯èª¤
- [ ] æ–‡æœ¬èˆ‡éŸ³è¨Šå…§å®¹å®Œå…¨ä¸€è‡´
- [ ] ä½¿ç”¨æ¨™æº–ä¸­æ–‡è¡¨é”

### æ ¼å¼æª¢æŸ¥ï¼š
- [ ] CSVæª”æ¡ˆæ ¼å¼æ­£ç¢º
- [ ] æª”æ¡ˆåç¨±èˆ‡éŸ³è¨Šæª”æ¡ˆä¸€è‡´
- [ ] æ²’æœ‰é‡è¤‡çš„æª”æ¡ˆåç¨±
- [ ] æ‰€æœ‰å¿…éœ€æ¬„ä½éƒ½å·²å¡«å¯«

### å¤šæ¨£æ€§æª¢æŸ¥ï¼š
- [ ] æ¶µè“‹å¤šå€‹ä¸åŒé ˜åŸŸ
- [ ] åŒ…å«ä¸åŒé›£åº¦ç­‰ç´šçš„æ¨£æœ¬
- [ ] æœ‰å¤šå€‹ä¸åŒèªªè©±è€…ï¼ˆå¦‚æœå¯èƒ½ï¼‰
- [ ] å¥å­é•·åº¦å’Œè¤‡é›œåº¦æœ‰è®ŠåŒ–

## ğŸš€ å¿«é€Ÿé–‹å§‹ç¯„ä¾‹

### æ­¥é©Ÿ 1ï¼šæº–å‚™è³‡æ–™å¤¾
```bash
mkdir -p test_dataset/audio
```

### æ­¥é©Ÿ 2ï¼šæ”¾ç½®éŸ³è¨Šæª”æ¡ˆ
å°‡ä½ çš„ `.wav` æª”æ¡ˆæ”¾å…¥ `test_dataset/audio/` è³‡æ–™å¤¾

### æ­¥é©Ÿ 3ï¼šå‰µå»º CSV æª”æ¡ˆ
æ ¹æ“š `test_references_example.csv` çš„æ ¼å¼å‰µå»ºä½ çš„åƒè€ƒæ–‡æœ¬æª”æ¡ˆ

### æ­¥é©Ÿ 4ï¼šé©—è­‰è³‡æ–™
```python
import pandas as pd
import os

# è®€å–CSV
df = pd.read_csv("test_dataset/test_references.csv")

# æª¢æŸ¥æª”æ¡ˆæ˜¯å¦å­˜åœ¨
for filename in df['filename']:
    audio_path = f"test_dataset/audio/{filename}"
    if not os.path.exists(audio_path):
        print(f"âŒ æ‰¾ä¸åˆ°æª”æ¡ˆ: {filename}")

print(f"âœ… è³‡æ–™é›†åŒ…å« {len(df)} å€‹æ¨£æœ¬")
```

### æ­¥é©Ÿ 5ï¼šåŸ·è¡Œè©•ä¼°
```bash
python evaluate_test_dataset.py
```

## ğŸ“ å¸¸è¦‹å•é¡Œ

### Q: éŸ³è¨Šæª”æ¡ˆå¤ªå¤§æ€éº¼è¾¦ï¼Ÿ
A: ä½¿ç”¨éŸ³è¨Šè™•ç†å·¥å…·é™ä½å–æ¨£ç‡æˆ–ç¸®çŸ­æ™‚é•·

### Q: å¦‚ä½•è™•ç†é›œéŸ³ï¼Ÿ
A: ä½¿ç”¨éŸ³è¨Šç·¨è¼¯è»Ÿé«”ï¼ˆå¦‚Audacityï¼‰é€²è¡Œé™å™ªè™•ç†

### Q: è½‰éŒ„æ–‡æœ¬æ‡‰è©²åŒ…å«æ¨™é»ç¬¦è™Ÿå—ï¼Ÿ
A: å»ºè­°åŒ…å«åŸºæœ¬æ¨™é»ç¬¦è™Ÿï¼Œä½†é¿å…éæ–¼è¤‡é›œçš„æ¨™é»

### Q: å¯ä»¥æ··åˆä¸åŒèªè¨€å—ï¼Ÿ
A: å»ºè­°å–®ä¸€æ¸¬è©¦é›†ä½¿ç”¨åŒä¸€ç¨®èªè¨€ï¼Œç¢ºä¿è©•ä¼°çš„ä¸€è‡´æ€§

## ğŸ’¡ é€²éšæŠ€å·§

### 1. å¹³è¡¡è³‡æ–™é›†
- ç¢ºä¿æ¯å€‹é ˜åŸŸçš„æ¨£æœ¬æ•¸é‡ç›¸å°å‡è¡¡
- é¿å…æŸå€‹èªªè©±è€…çš„æ¨£æœ¬éå¤š

### 2. åˆ†å±¤è©•ä¼°
- å»ºç«‹å¤šå€‹å°çš„å°ˆé–€æ¸¬è©¦é›†
- é‡å°ä¸åŒæ‡‰ç”¨å ´æ™¯é€²è¡Œå°ˆé …è©•ä¼°

### 3. æŒçºŒæ›´æ–°
- å®šæœŸæ”¶é›†æ–°çš„æ¸¬è©¦æ¨£æœ¬
- æ ¹æ“šæ¨¡å‹è¡¨ç¾èª¿æ•´æ¸¬è©¦é›†å…§å®¹

é€™æ¨£çš„æ¸¬è©¦è³‡æ–™é›†å¯ä»¥è®“ä½ æ›´æº–ç¢ºåœ°è©•ä¼°æ¨¡å‹åœ¨å¯¦éš›æ‡‰ç”¨ä¸­çš„è¡¨ç¾ï¼ 